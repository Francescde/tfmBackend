import geog
import networkx as nx
import osmgraph.osmgraph as osmgraph
import geojsonio
import json
from pyroutelib3.pyroutelib3 import Router

from time import time

def line_intersection(line1, line2):
    xdiff = (line1[0][0] - line1[1][0], line2[0][0] - line2[1][0])
    ydiff = (line1[0][1] - line1[1][1], line2[0][1] - line2[1][1]) #Typo was here

    def det(a, b):
        return a[0] * b[1] - a[1] * b[0]

    div = det(xdiff, ydiff)
    if div == 0:
        return False

    d = (det(*line1), det(*line2))
    x = det(d, xdiff) / div
    #y = det(d, ydiff) / div
    return (line1[0][0] >x and line1[1][0] <x) or (line1[0][0] <x and line1[1][0] >x)


# By default any way with a highway tag will be loaded
g = osmgraph.parse_file('connexioGRAPH2.osm')  # or .osm or .pbf
for n1, n2 in g.edges:
    c1, c2 = osmgraph.tools.coordinates(g, (n1, n2))
    g[n1][n2]['length'] = geog.distance(c1, c2)


import random
print('numNodes')
print(len(g.nodes))
#start = random.choice(list(g.nodes))
#end = random.choice(list(g.nodes))
#starts=[]#-172242;
#ends=[]
#for x in range(5):
#    starts.append(random.choice(list(g.nodes)))
#for x in range(100):
#    ends.append(random.choice(list(g.nodes)))
#-150830,-131320, -150802, -131370
oldConnectats=[-147456, -90106, -147444, -172002, -81882, -131034, -155606, -122834, -106448, -147406, -122828, -122824, -147400, -155588, -40898, -114624, -122816, -73658, -122810, -147386, -106424, -122800, -49068, -171948, -155562, -122794, -65448, -147368, -171944, -115586, -122788, -40868, -122786, -147362, -90016, -171940, -122782, -147358, -139168, -122774, -147348, -106386, -171920, -122762, -155528, -98182, -98180, -122752, -57212, -106364, -155514, -122740, -130928, -98148, -155492, -40802, -40804, -73568, -73570, -98140, -114520, -171860, -147282, -114512, -147278, -171852, -114506, -171848, -155460, -89910, -89908, -163628, -147242, -163624, -40738, -106268, -171804, -147224, -122648, -106254, -147198, -40692, -171756, -130788, -114396, -73434, -57050, -122582, -138962, -122562, -89788, -147132, -171706, -89786, -155320, -147128, -89782, -122552, -89780, -171698, -122546, -89774, -147118, -89772, -48806, -122532, -89762, -40610, -73376, -73374, -147098, -89752, -73366, -73364, -73362, -73360, -81552, -56974, -81550, -65162, -73352, -65160, -73350, -147078, -171650, -40578, -114304, -147074, -147060, -171632, -147056, -48750, -48748, -147052, -73322, -122474, -73320, -147046, -147044, -97890, -89696, -48734, -147034, -122454, -89684, -122450, -114258, -89682, -147026, -147022, -147024, -171596, -114252, -73290, -56906, -56904, -73288, -56908, -89664, -89662, -147000, -138802, -171568, -155184, -171566, -146992, -146990, -130602, -146982, -56864, -56862, -146974, -163356, -146970, -163348, -155154, -146962, -163344, -56840, -146950, -146948, -155138, -48638, -146936, -171510, -89584, -73200, -73198, -130542, -81384, -146920, -130532, -146916, -73180, -73178, -171472, -89550, -105934, -146892, -146890, -146888, -171458, -105922, -146882, -105918, -138682, -146866, -114096, -122286, -73126, -122276, -73124, -138658, -146842, -56724, -146836, -163218, -73106, -73104, -138640, -122256, -146830, -114058, -56712, -155014, -56710, -56708, -146820, -163200, -40320, -48510, -40318, -105852, -138620, -146808, -56694, -56692, -171378, -114032, -171374, -163180, -40298, -40296, -146788, -146780, -146776, -40280, -40278, -146770, -138570, -146762, -154952, -154946, -146754, -146750, -113978, -146746, -73014, -154934, -73012, -146742, -81196, -146732, -146730, -154918, -146724, -122146, -122144, -89372, -113948, -146714, -146712, -163092, -72978, -146706, -154896, -72976, -154894, -138512, -48396, -146702, -122122, -146698, -40198, -40196, -163076, -146692, -154884, -146688, -122108, -89338, -113914, -122104, -154874, -154870, -171250, -146674, -122096, -130288, -146672, -113900, -146666, -113898, -130278, -113892, -97500, -56540, -146652, -113882, -122072, -113880, -154834, -171218, -72910, -72908, -113864, -154822, -146620, -122044, -40122, -138426, -40120, -122040, -122042, -154806, -154804, -122036, -122032, -122030, -89260, -171178, -122024, -122022, -122018, -122008, -130190, -89228, -130188, -130184, -146566, -130178, -121982, -146556, -72826, -72824, -113784, -130166, -130164, -48244, -154738, -130162, -81008, -121966, -113770, -162920, -48228, -162916, -89186, -48226, -154722, -121954, -40028, -105564, -40026, -121944, -146518, -121932, -105546, -154698, -89158, -97350, -97348, -89156, -146502, -113728, -138298, -146490, -121914, -56374, -80950, -56372, -130100, -72752, -162862, -138284, -162856, -121896, -89120, -146464, -121878, -121876, -121870, -154634, -146436, -39934, -146430, -39932, -72702, -154620, -154616, -80884, -146416, -64494, -146412, -113644, -121836, -80870, -130020, -80868, -154594, -138208, -170968, -170966, -121814, -162772, -146388, -39890, -113620, -39888, -56274, -162774, -138188, -154566, -154562, -138168, -154552, -138166, -129968, -154532, -105378, -121762, -162722, -80796, -88984, -105368, -170904, -121752, -154514, -154512, -48014, -138126, -48012, -138124, -146312, -105350, -138114, -48000, -47998, -121726, -154492, -162684, -47994, -138104, -170870, -47986, -170860, -105322, -121704, -129894, -56166, -105316, -121698, -154464, -97118, -39772, -105308, -39770, -105302, -121686, -170836, -47954, -154450, -88912, -105298, -121680, -121682, -154444, -121676, -121674, -88904, -121672, -170820, -105284, -154434, -121666, -154432, -121662, -105276, -47932, -47930, -170802, -162606, -72492, -154412, -162602, -170794, -113450, -121644, -170784, -121632, -121630, -56088, -121624, -129814, -56086, -121620, -121618, -97040, -121616, -121614, -56074, -97032, -56072, -170752, -72448, -170750, -88830, -88828, -56064, -105210, -162554, -56062, -121592, -129782, -154352, -80622, -162542, -121576, -129762, -121570, -88800, -105178, -80598, -146128, -170700, -137930, -170696, -105158, -105156, -121538, -146114, -96958, -170686, -170684, -137914, -105144, -137912, -80566, -170678, -170676, -80564, -137908, -88758, -154288, -170672, -88752, -121518, -170668, -88744, -39588, -39586, -137890, -121506, -162464, -105118, -146076, -170650, -121498, -162454, -170640, -170638, -121484, -105098, -129674, -170626, -162430, -170622, -113276, -162426, -88696, -121464, -121460, -162418, -64104, -64102, -154212, -121436, -170584, -137816, -105040, -105038, -137806, -170566, -121414, -88638, -170558, -162366, -170556, -39482, -105016, -64052, -129586, -55858, -154158, -154138, -170522, -162328, -104982, -121362, -162318, -121354, -121352, -104964, -170498, -121344, -113150, -162300, -63994, -88566, -121334, -80372, -88564, -121330, -121332, -121328, -170478, -113134, -137696, -47584, -170456, -55762, -121296, -121288, -72134, -121276, -39356, -39354, -137660, -137654, -121268, -170420, -121262, -154028, -55724, -121256, -162214, -121254, -104868, -121252, -154018, -113058, -137632, -80286, -104862, -104858, -113044, -113038, -104844, -153988, -104836, -153982, -162172, -145782, -137590, -63858, -162162, -145776, -63856, -104810, -153960, -39270, -104804, -39268, -137568, -55646, -162142, -39260, -39258, -80218, -145746, -112978, -170320, -162126, -112972, -72008, -153926, -153924, -153918, -162106, -153910, -145718, -162100, -153904, -63792, -129326, -145712, -112934, -47396, -112928, -162080, -170270, -80152, -80150, -153876, -80148, -39186, -80146, -39184, -162064, -153874, -104716, -137484, -153866, -121090, -153858, -153856, -39164, -153852, -88310, -88308, -162036, -104690, -162034, -63726, -170220, -153828, -104676, -47330, -55518, -96476, -96474, -39128, -153816, -63704, -170192, -96458, -153802, -39112, -39110, -145606, -96452, -170174, -112830, -153786, -104634, -145594, -145574, -39074, -39072, -129184, -120990, -104606, -170144, -153754, -88218, -104600, -153746, -39052, -120968, -120966, -153734, -145540, -88194, -88192, -137340, -104570, -137336, -170100, -79986, -63600, -112742, -88156, -161882, -137306, -79960, -137300, -71762, -137298, -120904, -38980, -137274, -137272, -120886, -112692, -112690, -112688, -112684, -120874, -112682, -104488, -137256, -47142, -137254, -153638, -120866, -79906, -161822, -129040, -104462, -137230, -88076, -153608, -79874, -120834, -153596, -169980, -137210, -120828, -153592, -137206, -145398, -104436, -153586, -120818, -161776, -120814, -169966, -120810, -153574, -153568, -120796, -112598, -153550, -87998, -47038, -47036, -79802, -161712, -128940, -79788, -161706, -137126, -79780, -169892, -153506, -120736, -79776, -161692, -120732, -55194, -104348, -120728, -79768, -79766, -120724, -161684, -153490, -104340, -161680, -120714, -161668, -120706, -104320, -87934, -120702, -120696, -46968, -161654, -145266, -161648, -104302, -120682, -120678, -137062, -161638, -145250, -120670, -161626, -104282, -128848, -104256, -112438, -161582, -104234, -128808, -145186, -145184, -169760, -145182, -104222, -104224, -120600, -120598, -145174, -46868, -104212, -104206, -136972, -161542, -161536, -136958, -161526, -46836, -79604, -161522, -63212, -112364, -153320, -161512, -136930, -153312, -136928, -79584, -55006, -79582, -104146, -161488, -46800, -63182, -104138, -161478, -169668, -120514, -169658, -112312, -120500, -112308, -120498, -120492, -112298, -161450, -120486, -153252, -120482, -120478, -161434, -104086, -153236, -71312, -46736, -71310, -153228, -104074, -145028, -104066, -87678, -153212, -153210, -161400, -153202, -104046, -153194, -46696, -120424, -46694, -79454, -153172, -128594, -104012, -120396, -120392, -104006, -144966, -153158, -103998, -120382, -103996, -87612, -161334, -144944, -144940, -46636, -128550, -103972, -54818, -169502, -144918, -136724, -153106, -62994, -144912, -161292, -153084, -62966, -62964, -62962, -169446, -161254, -153054, -161246, -161242, -46554, -144856, -62936, -161234, -120272, -161232, -87502, -169422, -144840, -153032, -136642, -128448, -95680, -136636, -128436, -153010, -95660, -136620, -136614, -46498, -144796, -62876, -120218, -62874, -161178, -128400, -152974, -120206, -152972, -152960, -161150, -87416, -87414, -128370, -54630, -161126, -152926, -79198, -128348, -136534, -152914, -161100, -95558, -128322, -111938, -95552, -161088, -128314, -152882, -161068, -120106, -128296, -152870, -128290, -128286, -103706, -120090, -120086, -152850, -120082, -111890, -152846, -136462, -120076, -152842, -111880, -161030, -87300, -120068, -103680, -161018, -79084, -161002, -111850, -103654, -136422, -103652, -120032, -62686, -79066, -160984, -128216, -128214, -128202, -111814, -87228, -119996, -160950, -169138, -128174, -54444, -79018, -169126, -160930, -103586, -119966, -160924, -119958, -103574, -128148, -103570, -103554, -119936, -119932, -152692, -144500, -128110, -160876, -103530, -103520, -160862, -136276, -160852, -160850, -144464, -160844, -136264, -169030, -160836, -169028, -103486, -128060, -136250, -87096, -87094, -160820, -46130, -128042, -144424, -62498, -128028, -152594, -152590, -128004, -119810, -78836, -152564, -78834, -54256, -127982, -160738, -119774, -160734, -119772, -136152, -78802, -168910, -168906, -160712, -86980, -78786, -160702, -144318, -111550, -103354, -111542, -86958, -136106, -144286, -62360, -152472, -62358, -168852, -152466, -86922, -119690, -86920, -119688, -119686, -144266, -119684, -103298, -86908, -168822, -45942, -119668, -103284, -144242, -152432, -168814, -152428, -168812, -127850, -119656, -111460, -111458, -168798, -62300, -119640, -160592, -168778, -160580, -127798, -54068, -160564, -103216, -127790, -127786, -86824, -103202, -160544, -45854, -160540, -103196, -45852, -54040, -152340, -127764, -160530, -119556, -127748, -160512, -127742, -152318, -127730, -86768, -127728, -70380, -70378, -160490, -160488, -152294, -160480, -86748, -86746, -53976, -53974, -160468, -127698, -103114, -168648, -127676, -111292, -160440, -168624, -168622, -111276, -119464, -111264, -160404, -53902, -144014, -160396, -168586, -160392, -152198, -53894, -53892, -103044, -135810, -127616, -168574, -78448, -168554, -103012, -45666, -119392, -102994, -53840, -53838, -102990, -86602, -86600, -102980, -152118, -143920, -70190, -70182, -160292, -168474, -53786, -160282, -135698, -127506, -143888, -152078, -152076, -102916, -135682, -111104, -127478, -127476, -152040, -160226, -160224, -160216, -168406, -168400, -152010, -102856, -168390, -102850, -160194, -61888, -111040, -86460, -135612, -78268, -127406, -78250, -78248, -143780, -160162, -111006, -168346, -143770, -86418, -45454, -78220, -53644, -151942, -127364, -102786, -160128, -160126, -78204, -168316, -143738, -45430, -160118, -45428, -151924, -135538, -86380, -86378, -86376, -78174, -143706, -143704, -110930, -94544, -94542, -45388, -127298, -45374, -143676, -45372, -135476, -151856, -135470, -151850, -168232, -160032, -168220, -86294, -45324, -135436, -86274, -86272, -151806, -151802, -53498, -78072, -53496, -119026, -151792, -151784, -110824, -45284, -110818, -151774, -168154, -135384, -135380, -45266, -45264, -110796, -127168, -45246, -135356, -78000, -53420, -151720, -94372, -94370, -143522, -151712, -77982, -45208, -45206, -127114, -77960, -159872, -159870, -159868, -61558, -77938, -151660, -168040, -94308, -102500, -94306, -102486, -94292, -94288, -159822, -127046, -102470, -168004, -102466, -168002, -168000, -110656, -102460, -45116, -45114, -159804, -159800, -110646, -86064, -127024, -86062, -77870, -77868, -167970, -167966, -143386, -167954, -102410, -102400, -102388, -86000, -53232, -102382, -151530, -167908, -102372, -167902, -143326, -110552, -102360, -102356, -151506, -143314, -151504, -167890, -110540, -102348, -167882, -159690, -143304, -151496, -102342, -102338, -151488, -102332, -102328, -135094, -167858, -102322, -159660, -102316, -44968, -44966, -102310, -135078, -167842, -159648, -94112, -69534, -110494, -151446, -167826, -102288, -159630, -167820, -102284, -77706, -85896, -126854, -102274, -102266, -102262, -102260, -135026, -102256, -102254, -143214, -167788, -143204, -118626, -143202, -159582, -102230, -143188, -102222, -159562, -167754, -167752, -102216, -102214, -167748, -102212, -159554, -143170, -110400, -134980, -143166, -102202, -167736, -85814, -134964, -53044, -167732, -44848, -167728, -44846, -167726, -44844, -102190, -44842, -102186, -102182, -134950, -143140, -134946, -44830, -159518, -44828, -143134, -44826, -61212, -102172, -167698, -61202, -44816, -167696, -143120, -44812, -167684, -126724, -85762, -69378, -118526, -167678, -143102, -143098, -44794, -44792, -167670, -167668, -126706, -44776, -44774, -85730, -159458, -85728, -77518, -143054, -85708, -143046, -126658, -85696, -44734, -44726, -118450, -143026, -102064, -167586, -102050, -93854, -167580, -167576, -142998, -102038, -44684, -167562, -93832, -159364, -167556, -52856, -134772, -44644, -167522, -44642, -151132, -167514, -134746, -118360, -61014, -110164, -44624, -110160, -126544, -93770, -93764, -44612, -44610, -142914, -159300, -85558, -126518, -167472, -134704, -101932, -85542, -167458, -134672, -142860, -167432, -134660, -134658, -101886, -151032, -151028, -167410, -159218, -159216, -142828, -159212, -167398, -167392, -142816, -77278, -167380, -167378, -134608, -134606, -142794, -159178, -159168, -142780, -52668, -150966, -118194, -44466, -44464, -101810, -134574, -159152, -159148, -134568, -134566, -52644, -142756, -134562, -52642, -167328, -142750, -101788, -167324, -167322, -159128, -150936, -118166, -93586, -167314, -159120, -167310, -118154, -159114, -101756, -159100, -52602, -52600, -167286, -142706, -126318, -85356, -118114, -126300, -167258, -101722, -142680, -167252, -134484, -60754, -150866, -44366, -44364, -118090, -167242, -142664, -134470, -167238, -159044, -44354, -44352, -150848, -159038, -101686, -159028, -142636, -109862, -142626, -134432, -142624, -142622, -159008, -118040, -142614, -44302, -167182, -44300, -118026, -93446, -134406, -52484, -44290, -44288, -134398, -134394, -150768, -142570, -77032, -142566, -142560, -134360, -44246, -52434, -158926, -158920, -101570, -76994, -76992, -158914, -150716, -158904, -158902, -150708, -101550, -167084, -134314, -142506, -142504, -117914, -158874, -60566, -52362, -117892, -142462, -44158, -142458, -150646, -142448, -76910, -76908, -150632, -126050, -60510, -60508, -158808, -44120, -85074, -126034, -126030, -44102, -142404, -44100, -142402, -60478, -150582, -117812, -142388, -44076, -44074, -85030, -150566, -85028, -101412, -68638, -76830, -76828, -158748, -125976, -125974, -142348, -101388, -150532, -52224, -125952, -142334, -125950, -125948, -150524, -125946, -150522, -125944, -117752, -60406, -125940, -117748, -125936, -166894, -134120, -76774, -125924, -101348, -125922, -93152, -93150, -93148, -93146, -125912, -142296, -125908, -125906, -125904, -134094, -125900, -125898, -125896, -158664, -109512, -150468, -125886, -125884, -166844, -125878, -134068, -117684, -101298, -125876, -125872, -125870, -166830, -52138, -125866, -117672, -52136, -125864, -142250, -125860, -60324, -125858, -142242, -125854, -52124, -125850, -101272, -125842, -101262, -101260, -158604, -60296, -125830, -101254, -109444, -142210, -101246, -142206, -166782, -142202, -52086, -84852, -84850, -84848, -166760, -43876, -43874, -84832, -52058, -166746, -101208, -84818, -76626, -84816, -76624, -93004, -142152, -84800, -84798, -43834, -125752, -142132, -125748, -125744, -101168, -109358, -142128, -125738, -125736, -142118, -125732, -125728, -142110, -142108, -125722, -117528, -150296, -125718, -150294, -125716, -142102, -125714, -142098, -142096, -76558, -43786, -125704, -142088, -125702, -125698, -142070, -43764, -142068, -43762, -158450, -125680, -142060, -51944, -166632, -158438, -51940, -125668, -125666, -142052, -117472, -125658, -125646, -101070, -101068, -142026, -117448, -133832, -101064, -142022, -117438, -84662, -92842, -141990, -133788, -101018, -109208, -158358, -109200, -166542, -141962, -117376, -117372, -125560, -158326, -150120, -150118, -158310, -141920, -100956, -100952, -76372, -84562, -84560, -125516, -43594, -158280, -125510, -92738, -92736, -133692, -84540, -158266, -117306, -158264, -141878, -117302, -43560, -76324, -109092, -84508, -100892, -43544, -43542, -100886, -141844, -43534, -100878, -141834, -158216, -100862, -43510, -100854, -43508, -133614, -141806, -117226, -133610, -109032, -125418, -125412, -100836, -117212, -141788, -109012, -100820, -43472, -43470, -125388, -43466, -125382, -43450, -158136, -158134, -141746, -108972, -43430, -125348, -108962, -125346, -43424, -117150, -125342, -158102, -84364, -108940, -84362, -158090, -133508, -125316, -43384, -43382, -43380, -141684, -100722, -100720, -125294, -108906, -76136, -100708, -100706, -100704, -100702, -100700, -100698, -43354, -100696, -43352, -100694, -59738, -43346, -133456, -125262, -43340, -133450, -43334, -158022, -43332, -108866, -84290, -141634, -149820, -43318, -133426, -149804, -43308, -43306, -51496, -133416, -84262, -141598, -141596, -166170, -108824, -117014, -43282, -117010, -141584, -166160, -43278, -141582, -43276, -117004, -117006, -117000, -84230, -84228, -141572, -116992, -141564, -116982, -125174, -116978, -116976, -84204, -84202, -116970, -108778, -116964, -116962, -108770, -108768, -125152, -166104, -116952, -51414, -116946, -116940, -166086, -51394, -116930, -51392, -125118, -116926, -125116, -116924, -125112, -157880, -125108, -75952, -141484, -125090, -84124, -133274, -84122, -157848, -116886, -108692, -59540, -59538, -149652, -108678, -116864, -43134, -116862, -108668, -149626, -59508, -108652, -116844, -116840, -43102, -43100, -108636, -149596, -100440, -141396, -133198, -125006, -108620, -165964, -133194, -84036, -84034, -43070, -43068, -84026, -108600, -165942, -157746, -141338, -108564, -141326, -43020, -108556, -116742, -124932, -165892, -124928, -43006, -165886, -124922, -75766, -75764, -165876, -108532, -108528, -157674, -149482, -157672, -165840, -124878, -108494, -124876, -157642, -83910, -108486, -157638, -141254, -108480, -100282, -108470, -124848, -157606, -51108, -108452, -124832, -141216, -83870, -100254, -149404, -157590, -141206, -141202, -157580, -124812, -141196, -157572, -141176, -124788, -42864, -42862, -141164, -124778, -141162, -51044, -141156, -132946, -149330, -149328, -116558, -116552, -132936, -124744, -108354, -132924, -141116, -165690, -149306, -157496, -75576, -157494, -149294, -141100, -132906, -157478, -157464, -149270, -75538, -83722, -124666, -141050, -141048, -124664, -157430, -141044, -42736, -124656, -42734, -59116, -67302, -157410, -100066, -124640, -67294, -83652, -116418, -140992, -108222, -149182, -132784, -108206, -124590, -157354, -140970, -140958, -157338, -140954, -59022, -124544, -140926, -149114, -140920, -116340, -140912, -124522, -116328, -58984, -124520, -108128, -149086, -140894, -116316, -165468, -149080, -75350, -165462, -149074, -116306, -149072, -116300, -149068, -91720, -149064, -116294, -124486, -149060, -140870, -99906, -149056, -42558, -42556, -149052, -157244, -157240, -124470, -149040, -149038, -58926, -149032, -124456, -132646, -116262, -149026, -116258, -149022, -149016, -140824, -75286, -149012, -149010, -149006, -157198, -149000, -42502, -148998, -42500, -91652, -148996, -140804, -108032, -116218, -157178, -58870, -140784, -50670, -50668, -157162, -148968, -157156, -124384, -140768, -99804, -148954, -99802, -107992, -157138, -148946, -148940, -165322, -165318, -157122, -50626, -148930, -107966, -148926, -140734, -140722, -91568, -107948, -140712, -148900, -42396, -42394, -42392, -99736, -99734, -140694, -148880, -148876, -157064, -107906, -91518, -107902, -140668, -157050, -157046, -148840, -132452, -132448, -75102, -148828, -75100, -157018, -140634, -140636, -124248, -140630, -165210, -99668, -91474, -157002, -140614, -140612, -156992, -116032, -124220, -124218, -165178, -91448, -140598, -124212, -75048, -148776, -75046, -156962, -140564, -140562, -140560, -124176, -124174, -75020, -50438, -165126, -50436, -107778, -140546, -140544, -140540, -132346, -140538, -140536, -140534, -132338, -140524, -156884, -42194, -156882, -42192, -156878, -156874, -148682, -140488, -156872, -107718, -124104, -156868, -140482, -74946, -115904, -83136, -83134, -156864, -42172, -156860, -115898, -50360, -156856, -156852, -156850, -156844, -83114, -156842, -50344, -91304, -83112, -91302, -156838, -156836, -156834, -42144, -74912, -74910, -58524, -91288, -42132, -156820, -42128, -156814, -156812, -124040, -156806, -124036, -156804, -42114, -156802, -156798, -156796, -156794, -148600, -156790, -164980, -156788, -156786, -156784, -156782, -50284, -156780, -42090, -156778, -91240, -156776, -132198, -156774, -91236, -132196, -124002, -91234, -156770, -156772, -156766, -140380, -156764, -156762, -156760, -156758, -42068, -156756, -156754, -132176, -140364, -156748, -42058, -99400, -156744, -132166, -148552, -156738, -115776, -156736, -164926, -83006, -115772, -123964, -156730, -132156, -132152, -156732, -132154, -132158, -91182, -58414, -164906, -50216, -156712, -156708, -156706, -140320, -156702, -140318, -156698, -66584, -156694, -140310, -156692, -156690, -148498, -148496, -156688, -156686, -140304, -132108, -156684, -156682, -140302, -123912, -156678, -140294, -41988, -156676, -41986, -156674, -156672, -123902, -156670, -140284, -58366, -156666, -123894, -156662, -156660, -58354, -156658, -115696, -107504, -156654, -99314, -50156, -156652, -123888, -156648, -123880, -115686, -156646, -156644, -140260, -148454, -123878, -156640, -140256, -123874, -156636, -123864, -99286, -115660, -140232, -140226, -99258, -58296, -82872, -99256, -164792, -164788, -140210, -132016, -123824, -123816, -41888, -82846, -91036, -140188, -140186, -131992, -140184, -140182, -123800, -140180, -164756, -140178, -140176, -82832, -140174, -50060, -140172, -50058, -140170, -91014, -91012, -131972, -50050, -140164, -74624, -140160, -66430, -140158, -140156, -164738, -140154, -115578, -140152, -115584, -140150, -140148, -164724, -140146, -164722, -140144, -115568, -164720, -140136, -115560, -50020, -107364, -50018, -140132, -148320, -148322, -140126, -115554, -107356, -140124, -140122, -140120, -164696, -140118, -115540, -99152, -140112, -49994, -58184, -131908, -172862, -49980, -140088, -123696, -107304, -148252, -148250, -107290, -41750, -164628, -164622, -41740, -164620, -49930, -164616, -123652, -172804, -172802, -172800, -90880, -172798, -90878, -148224, -49914, -115448, -156404, -131816, -41702, -123620, -123616, -139996, -164564, -74450, -123602, -74448, -139986, -164558, -139984, -139980, -123594, -115402, -99014, -172736, -41660, -41658, -156344, -98994, -66226, -156334, -172716, -107178, -139940, -123552, -66208, -74398, -172704, -115358, -90772, -139922, -115342, -57996, -115340, -115338, -115336, -123522, -107136, -90752, -90748, -115324, -107124, -41586, -41584, -139886, -90716, -156250, -172632, -156246, -164434, -139856, -139842, -148030, -172606, -115260, -164410, -156214, -107060, -90672, -156208, -164396, -49704, -115228, -107034, -164370, -90638, -164366, -90636, -49674, -115202, -131576, -115192, -74216, -74214, -115172, -90592, -90590, -49628, -139740, -90586, -115164, -156114, -57808, -115152, -156110, -90560, -90558, -131514, -131512, -106930, -57776, -164270, -106924, -90540, -131500, -65964, -98728, -106914, -123294, -106910, -90524, -74134, -172436, -131476, -172430, -164238, -90508, -98700, -156042, -172428, -147848, -74118, -172422, -123268, -156030, -172404, -172402, -41330, -41328, -74094, -172398, -74092, -106862, -164200, -106854, -164198, -41312, -106844, -155996, -131416, -41294, -74060, -106828, -41292, -164170, -172360, -90440, -90438, -106824, -123204, -82238, -155964, -82236, -115002, -90424, -147768, -74040, -164146, -155948, -90410, -139552, -164120, -172310, -114960, -114956, -164108, -41220, -41218, -172282, -106746, -172280, -90360, -131318, -131316, -57588, -172274, -131312, -106736, -172268, -172266, -106728, -114916, -131298, -114912, -131294, -131292, -123098, -147674, -106714, -172244, -131284, -172242, -106706, -73936, -73934, -164046, -131276, -82122, -172230, -131270, -106690, -106684, -172214, -172212, -172210, -164010, -164006, -164002, -90266, -147610, -123032, -131224, -147606, -131218, -106638, -49292, -98444, -49290, -131204, -123012, -131202, -131194, -106614, -131186, -41064, -131176, -41062, -73830, -73828, -131172, -106594, -131170, -131168, -131164, -139352, -131160, -106576, -98382, -163918, -131150, -172110, -106570, -139336, -122952, -131138, -98368, -122942, -114748, -147516, -106554, -57400, -172086, -155700, -147506, -114728, -90148, -163876, -122900, -122898, -40972, -40970, -122888, -155650]

def findConnections(nodes_conectats):
    actLen=0
    while actLen<len(nodes_conectats):
        actLen=len(nodes_conectats)
        for n1, n2 in g.edges:
            if(n1 in nodes_conectats):
                if n2 not in nodes_conectats:
                    nodes_conectats.append(n2)
                    for n3, n4 in g.edges:
                        if(n3 in nodes_conectats):
                            if (n4 not in nodes_conectats):
                                nodes_conectats.append(n4)
                        if(n4 in nodes_conectats):
                            if (n3 not in nodes_conectats):
                                nodes_conectats.append(n3)
            if(n2 in nodes_conectats):
                if n1 not in nodes_conectats:
                    nodes_conectats.append(n1)
                    for n3, n4 in g.edges:
                        if(n3 in nodes_conectats):
                            nodes_conectats.append(n4)
                        if(n4 in nodes_conectats):
                            nodes_conectats.append(n3)
    return nodes_conectats
#print(list(set(conectats)))
noCon=set(g.nodes)
conectats=oldConnectats
lenCon=0
i=0
while(len(noCon)>0):
    conectats=findConnections(conectats)
    noCon=noCon-set(conectats)
    #print(conectats)
    router = Router('foot2', "./connexioGRAPH2.osm")

    routeLonLats = osmgraph.tools.coordinates(g, set(conectats))
    if(i>0):
        print(conectats)
        #geojsonio.display(json.dumps({'type': 'MultiPoint', 'coordinates': routeLonLats,'properties':conectats}))#MultiPoint
    i+=1
    if(len(noCon)>0):
        conectats=[list(noCon)[0]]
    else:
        conectats=[]

'''
numConexions=0
conex=[]
for n1, n2 in g.edges:
    c1, c2 = osmgraph.tools.coordinates(g, (n1, n2))
    for n3, n4 in g.edges:
        if(n1 not in [n3,n4] or n2 not in [n3,n4]):
            c3, c4 = osmgraph.tools.coordinates(g, (n3, n4))
            if(line_intersection([c1,c2], [c3,c4])):
                #print(str(n1)+" "+str(n2)+" "+str(n3)+" "+str(n4)+" ")
                numConexions+=1
                conex.append([[c1,c2], [c3,c4]])
print("linees creuades")
print(numConexions)
print(conex)
'''


